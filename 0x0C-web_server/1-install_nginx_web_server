#!/usr/bin/env bash
# This script installs and configures Nginx on an Ubuntu machine.

# Install Nginx with the -y option to automatically answer yes to prompts
apt-get update
apt-get install -y nginx

# Start Nginx (not using systemctl)
/usr/sbin/nginx

# Create a simple HTML page with the content "Hello World!"
echo "Hello World!" > /usr/share/nginx/html/index.html

# Ensure Nginx is listening on port 80
listen_config="listen 80;"
if ! grep -q "$listen_config" /etc/nginx/sites-available/default; then
    echo "$listen_config" >> /etc/nginx/sites-available/default
fi

# Reload Nginx to apply the changes
/usr/sbin/nginx -s reload

# Check if Nginx is running
if pgrep -x "nginx" > /dev/null; then
    echo "Nginx is running."
else
    echo "Nginx is not running. Please check logs in /var/log/nginx/ for more information."
fi
